/* Do not edit this file to avoid losing your changes when upgrade the theme */
var BTCartPage={selectors:{content:".cart-page__content",updateAllBtn:".cart__update__all",qtyInput:".cart__qty-input",upsell:{wrap:".cart-page__upsell",content:".cart-page__upsell__content"},crosssell:{wrap:".cart-page__cross_sell",content:".cart-page__cross_sell__content"},itemsTable:".cart-page__items-table",countdown:".cart-countdown"},data:{cartUpsellRequests:[],cartCrosssellRequests:[],item_size:0},cleanOldUpsellRequests:function(){$(this.data.cartUpsellRequests).each(function(t,e){e&&4!=e.readyState&&e.abort()}),this.data.cartUpsellRequests=[]},cleanOldCrosssellRequests:function(){$(this.data.cartCrosssellRequests).each(function(t,e){e&&4!=e.readyState&&e.abort()}),this.data.cartCrosssellRequests=[]},loadUpsellProduct:function(){var c=this,d=this.selectors.upsell,u=$(d.wrap);0!=u.length&&(this.cleanOldUpsellRequests(),this.data.cartUpsellRequests.push(BT.callAjax(theme.cartUrl,"GET",{view:"upsell_tags"},null,function(t){try{var e=$.parseJSON(t.replace("\x3c!-- BEGIN template --\x3e","").replace("\x3c!-- cart.upsell_tags --\x3e","").replace("\x3c!-- END template --\x3e","")),s=[],l=$(d.content),n=e.length,i=[],o=upsellRandom?100:parseInt(u.attr("data-limit"));l.hasClass("slick-initialized")&&l.slick("unslick"),l.html(""),l.siblings(BT.selectors.loadingNotFull).show();var r=0;$(d.wrap).show();var a=u.attr("data-slider")?"upsell_slider":"upsell";0<n?$(e).each(function(t,e){c.data.cartUpsellRequests.push(BT.callAjax(theme.collectionAllUrl+"/"+e,"GET",{view:a},null,function(t){r++;var e=t.replace("\x3c!-- BEGIN template --\x3e\x3c!-- collection.upsell --\x3e","").replace("\x3c!-- END template --\x3e","");if($(".product-item",e).each(function(){var t=$(this).attr("data-id");s.indexOf(t)<0&&s.length<o&&(i.push($(this).html()),s.push(t))}),r==n)if(upsellRandom&&(i=BT.shuffleArray(i)),l.siblings(BT.selectors.loadingNotFull).hide(),0<i.length){var a=0;$(i).each(function(t,e){a<o&&l.append(e),a++}),BT.convertCurrencySilence(d.content+" span.money"),l.removeClass(BT.selectors.waitingData.replace(".","")),$(d.content).hasClass("slick-initialized")&&$(d.content).slick("unslick"),BT.applyCustomColorSwatches(l),BT.popularAddedWishlistItems(l),setTimeout(function(){BT.initSlider(d.wrap,!1)},500)}else $(d.wrap).hide()}))}):(l.siblings(BT.selectors.loadingNotFull).hide(),$(d.wrap).hide())}catch(t){}})))},loadCrosssellProduct:function(t){var a=this,e=this.selectors.crosssell,s=$(e.wrap);if(0!=s.length){if(this.cleanOldCrosssellRequests(),t){var l=$(this.selectors.itemsTable);if(0<l.length){var n=[];l.find("tbody .cart__row").each(function(){n.push($(this).attr("data-product-id"))}),s.attr("data-product-ids",n.join(","))}else s.attr("data-product-ids","")}var i=s.attr("data-product-ids");if(i){var o=i.split(","),r=parseInt(s.attr("data-limit")),c=[],d={},u=o.length,p=0,h=s.children(e.content);h.hasClass("slick-initialized")&&h.slick("unslick"),h.html(""),s.children(BT.selectors.loadingNotFull).show(),s.removeClass("hide"),$.each(o,function(t,e){a.data.cartCrosssellRequests.push(BT.callAjax(theme.recommendationUrl+".json","GET",{product_id:e,limit:r},"json",function(t){if(p++,0<t.products.length&&$.each(t.products,function(t,e){o.indexOf(e.id)<0&&(c[t]?c[t]=c[t]+","+e.handle:c[t]=e.handle,d[e.handle]=e.url)}),p==u)if((c=c.join(",").split(",").filter(function(t,e,a){return a.indexOf(t)>=e})).length>r&&(c=c.slice(0,r-1)),s.children(BT.selectors.loadingNotFull).hide(),0<c.length){var e=c.join(",");a.data.cartCrosssellRequests.push(BT.callAjax(theme.rootUrl,"GET",{view:"recommendation",q:e},null,function(t){h.html(t),BT.convertCurrencySilence(h.find("span.money")),BT.addRecommendationUrls(h,d),h.addClass(BT.selectors.slider.useTouchMobile+" "+BT.selectors.slider.default.replace(".","")),BT.initSlider(s,!1),BT.initDealCountdown(h),BT.applyCustomColorSwatches(h),BT.reLoadReview(h),BT.popularAddedWishlistItems(h)}))}else s.addClass("hide")}))})}else s.addClass("hide")}},initCartEvent:function(){var s=this;$(document).on("ajaxCart.afterCartLoad",function(){BT.callAjax(theme.cartUrl,"GET",{view:"ajax"},null,function(t){$(s.selectors.content).html($(s.selectors.content,t).html()),BT.convertCurrencySilence(s.selectors.content+" span.money");var e=s.data.item_size;s.updateItemSize(),e!=s.data.item_size&&(s.loadUpsellProduct(),s.loadCrosssellProduct(!0)),window.Shopify&&Shopify.StorefrontExpressButtons&&Shopify.StorefrontExpressButtons.initialize(),BT.resetCartTerms(),0==s.data.item_size&&0<$(s.selectors.countdown).length&&($(s.selectors.countdown).addClass("hide"),BT.setCookie("countdown_reverse_cart-page",null)),0<$("#shipping-calculator").length&&void 0!==Shopify.Cart&&void 0!==Shopify.Cart.ShippingCalculator&&Shopify.Cart.ShippingCalculator.show({submitButton:theme.strings.shippingCalcSubmitButton,submitButtonDisabled:theme.strings.shippingCalcSubmitButtonDisabled,customerIsLoggedIn:theme.strings.shippingCalcCustomerIsLoggedIn,moneyFormat:theme.strings.shippingCalcMoneyFormat}),BT.convertProgressBar()})}),$(document).on("click",this.selectors.updateAllBtn,function(t){t.preventDefault(),BT.showLoadingFull();var e={},a=[];$(s.selectors.qtyInput).each(function(){a.push($(this).val())}),e.updates=a,0<$("#CartSpecialInstructions").length&&(e.note=$("#CartSpecialInstructions").val()),BT.callAjax(theme.cartUpdateUrl,"POST",e,"json",function(t){BT.updateHeaderCartHtml(!0),BT.hideLoadingFull()})})},updateItemSize:function(){var t=$(this.selectors.itemsTable);0<t.length?this.data.item_size=t.find("tbody .cart__row").length:this.data.item_size=0},init:function(){this.initCartEvent()}};theme.cartTemplate={},theme.CartTemplateSection=function(t){BTCartPage.loadUpsellProduct(),BTCartPage.loadCrosssellProduct(!1),BTCartPage.updateItemSize(),BT.initDealCountdown(".cart-countdown")},theme.CartTemplateSection.prototype=_.assignIn({},theme.CartTemplateSection.prototype,{onSelect:function(t){t.detail.load&&0<$(".cart-countdown").length&&(BT.setCookie("countdown_reverse_cart-page",null),BT.initDealCountdown(".cart-countdown"))},onUnload:function(){}}),BTCartPage.init(),theme.sections.constructors["cart-template"]=theme.CartTemplateSection;